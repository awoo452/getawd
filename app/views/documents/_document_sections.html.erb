<% subheadings = document.subheadings || [] %>
<% body = document.body || [] %>
<% images = document.images || [] %>

<% subheadings.each_with_index do |subheading, index| %>
  <h3><%= subheading %></h3>
  <p><%= body[index].to_s %></p>

  <% img = images[index] %>
  <% if img.present? && img["file"].present? %>
    <figure>
      <% proxy_url = image_proxy_url(document_image_key(document, img), width: 1200, height: 900, fit: "inside", format: "webp") %>
      <%= fallback_image_tag(proxy_url, alt: img["alt"], loading: "lazy", decoding: "async") if proxy_url %>

      <figcaption><%= img["caption"] %></figcaption>
    </figure>
  <% end %>
<% end %>
