<% show_projects = local_assigns.fetch(:show_projects, true) %>
<ul>
  <% services.each do |service| %>
    <li>
      <h3><%= service.title %></h3>
      <% if service.category.present? %>
        <p class="service-category"><%= service.category %></p>
      <% end %>
      <p><%= service.description %></p>
      <% if service.image.present? %>
        <div class="card-image-frame">
          <% proxy_url = image_proxy_url("services/#{service.image}", width: 500, height: 500, fit: "inside", format: "webp") %>
          <%= fallback_image_tag proxy_url, class: "card-image", loading: "lazy", decoding: "async" if proxy_url %>
        </div>
      <% end %>
      <div>
        <div class="card-actions">
          <% anchor = service.projects_anchor %>
          <% if show_projects %>
            <%= link_to "View Projects", anchor.present? ? projects_path(anchor: anchor) : projects_path %>
          <% end %>
          <% if service.url.present? %>
            <%= link_to "Learn More", service.url, target: "_blank", rel: "noopener" %>
          <% else %>
            <%= link_to "Get Started", contact_path %>
          <% end %>
        </div>
      </div>
    </li>
  <% end %>
</ul>
